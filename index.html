<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>E-DocuQuest | Institutional Portal</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
.hidden{display:none}
video{border-radius:12px}
</style>
</head>

<body class="bg-emerald-50 font-sans text-gray-800">

<div class="max-w-6xl mx-auto p-6">

<!-- NAVIGATION -->
<div class="flex justify-center gap-8 mb-10">
<button onclick="show('request')" class="font-bold text-emerald-700">Request</button>
<button onclick="show('track')">Track</button>
<button onclick="show('admin')" class="text-sm text-gray-500">Admin</button>
</div>

<!-- ================= REQUEST ================= -->
<div id="request">

<h1 class="text-3xl font-bold text-center mb-6 text-emerald-700">
E-DocuQuest Official Document Portal
</h1>

<form id="requestForm" class="bg-white p-6 rounded-xl shadow space-y-4">

<input id="name" required placeholder="Full Name" class="w-full p-3 border rounded">
<input id="email" required type="email" placeholder="Email" class="w-full p-3 border rounded">

<select id="document" required class="w-full p-3 border rounded">
<option value="">Select Document</option>
<option>Form 137 (SF10 – Permanent Record)</option>
<option>Form 138 (SF9 – Report Card)</option>
<option>Certificate of Good Moral</option>
<option>Certificate of Graduation</option>
<option>Request / Transfer Letter</option>
</select>

<button class="w-full bg-emerald-600 text-white py-3 rounded font-bold">
Submit Request
</button>

</form>

<div id="requestFeedback" class="mt-6"></div>

<!-- DATA PRIVACY NOTICE -->
<div class="mt-6 text-xs text-gray-600 bg-white p-4 rounded shadow">
<strong>Data Privacy Notice:</strong>
All submitted personal data and identification documents are collected solely
for document processing and identity verification purposes in compliance with
data protection regulations. Access is restricted to authorized personnel only.
</div>

</div>

<!-- ================= TRACK ================= -->
<div id="track" class="hidden">

<div class="bg-white p-6 rounded-xl shadow max-w-xl mx-auto">
<h2 class="text-xl font-bold mb-4">Track Request</h2>

<input id="trackId" placeholder="Enter Tracking ID"
class="w-full p-3 border rounded mb-3">

<button onclick="trackStatus()"
class="w-full bg-emerald-600 text-white py-2 rounded">
Check Status
</button>

<div id="trackResult" class="mt-6"></div>
</div>

</div>

<!-- ================= ADMIN ================= -->
<div id="admin" class="hidden">

<div class="bg-white p-6 rounded-xl shadow">

<h2 class="text-xl font-bold mb-4">Admin Dashboard</h2>

<table class="w-full text-sm border">
<thead class="bg-emerald-600 text-white">
<tr>
<th class="p-2">ID</th>
<th class="p-2">Student</th>
<th class="p-2">Document</th>
<th class="p-2">Verification</th>
<th class="p-2">Status</th>
<th class="p-2">Actions</th>
</tr>
</thead>
<tbody id="adminTable"></tbody>
</table>

</div>
</div>

</div>

<script>
const SCRIPT_URL="YOUR_GOOGLE_SCRIPT_URL_HERE";
let trackingId="";

function show(section){
document.querySelectorAll("#request,#track,#admin")
.forEach(s=>s.classList.add("hidden"));
document.getElementById(section).classList.remove("hidden");
}

/* ================= REQUEST ================= */

document.getElementById("requestForm")
.addEventListener("submit",async e=>{
e.preventDefault();

trackingId="BNHS-"+Math.floor(10000+Math.random()*90000);

await fetch(SCRIPT_URL,{
method:"POST",
body:JSON.stringify({
action:"submit",
trackingId,
name:name.value,
email:email.value,
document:document.value,
status:"Pending Verification",
timestamp:new Date().toLocaleString()
})
});

document.getElementById("requestFeedback").innerHTML=
`<div class="bg-emerald-600 text-white p-4 rounded text-center">
Tracking ID: <strong>${trackingId}</strong><br>
Please wait for admin verification approval.
</div>`;
});

/* ================= TRACK ================= */

async function trackStatus(){
const id=document.getElementById("trackId").value;

const res=await fetch(SCRIPT_URL,{
method:"POST",
body:JSON.stringify({action:"track",trackingId:id})
});

const data=await res.json();

if(data.status==="Not Found"){
document.getElementById("trackResult").innerHTML=
"<div class='text-red-600'>Tracking ID not found.</div>";
return;
}

document.getElementById("trackResult").innerHTML=
`<div class="bg-emerald-100 p-4 rounded">
<strong>Status:</strong> ${data.status}<br>
<strong>Last Updated:</strong> ${data.timestamp}
</div>`;
}

/* ================= ADMIN ================= */

async function loadAdmin(){
const res=await fetch(SCRIPT_URL,{
method:"POST",
body:JSON.stringify({action:"loadAll"})
});

const data=await res.json();
const table=document.getElementById("adminTable");
table.innerHTML="";

data.reverse().forEach(row=>{
table.innerHTML+=`
<tr class="border-b">
<td class="p-2">${row.id}</td>
<td class="p-2">${row.name}</td>
<td class="p-2">${row.document}</td>
<td class="p-2">${row.verification}</td>
<td class="p-2">${row.status}</td>
<td class="p-2 space-x-2">
<button onclick="approve('${row.id}')"
class="bg-green-600 text-white px-2 py-1 rounded text-xs">Approve</button>
<button onclick="reject('${row.id}')"
class="bg-red-600 text-white px-2 py-1 rounded text-xs">Reject</button>
</td>
</tr>`;
});
}

async function approve(id){
await fetch(SCRIPT_URL,{
method:"POST",
body:JSON.stringify({action:"approve",trackingId:id})
});
loadAdmin();
}

async function reject(id){
await fetch(SCRIPT_URL,{
method:"POST",
body:JSON.stringify({action:"reject",trackingId:id})
});
loadAdmin();
}

</script>

</body>
</html>
